var hr=Object.defineProperty;var Dn=Object.getOwnPropertyDescriptor;var cr=(t,e)=>{for(var r in e)hr(t,r,{get:e[r],enumerable:!0})};var z=(t,e,r,n)=>{for(var i=n>1?void 0:n?Dn(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&hr(e,r,i),i};import{LitElement as $i,html as $n,css as ji}from"lit";import{customElement as Di,state as Ni}from"lit/decorators.js";import{repeat as Ci}from"lit/directives/repeat.js";import{ref as Bi,createRef as xi}from"lit/directives/ref.js";var Ft="delete",S=5,x=1<<S,A=x-1,v={};function Ee(){return{value:!1}}function K(t){t&&(t.value=!0)}function Ae(){}function yt(t){return t.size===void 0&&(t.size=t.__iterate(Nr)),t.size}function at(t,e){if(typeof e!="number"){var r=e>>>0;if(""+r!==e||r===4294967295)return NaN;e=r}return e<0?yt(t)+e:e}function Nr(){return!0}function oe(t,e,r){return(t===0&&!Br(t)||r!==void 0&&t<=-r)&&(e===void 0||r!==void 0&&e>=r)}function Wt(t,e){return Cr(t,e,0)}function ae(t,e){return Cr(t,e,e)}function Cr(t,e,r){return t===void 0?r:Br(t)?e===1/0?e:Math.max(0,e+t)|0:e===void 0||e===t?t:Math.min(e,t)|0}function Br(t){return t<0||t===0&&1/t===-1/0}var xr="@@__IMMUTABLE_ITERABLE__@@";function j(t){return Boolean(t&&t[xr])}var Kr="@@__IMMUTABLE_KEYED__@@";function O(t){return Boolean(t&&t[Kr])}var Pr="@@__IMMUTABLE_INDEXED__@@";function $(t){return Boolean(t&&t[Pr])}function se(t){return O(t)||$(t)}var b=function(e){return j(e)?e:B(e)},F=function(t){function e(r){return O(r)?r:ut(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(b),_t=function(t){function e(r){return $(r)?r:X(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(b),bt=function(t){function e(r){return j(r)&&!se(r)?r:Rt(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(b);b.Keyed=F;b.Indexed=_t;b.Set=bt;var Ur="@@__IMMUTABLE_SEQ__@@";function ke(t){return Boolean(t&&t[Ur])}var Fr="@@__IMMUTABLE_RECORD__@@";function Mt(t){return Boolean(t&&t[Fr])}function V(t){return j(t)||Mt(t)}var zt="@@__IMMUTABLE_ORDERED__@@";function H(t){return Boolean(t&&t[zt])}var Yt=0,J=1,U=2,Oe=typeof Symbol=="function"&&Symbol.iterator,Wr="@@iterator",ue=Oe||Wr,y=function(e){this.next=e};y.prototype.toString=function(){return"[Iterator]"};y.KEYS=Yt;y.VALUES=J;y.ENTRIES=U;y.prototype.inspect=y.prototype.toSource=function(){return this.toString()};y.prototype[ue]=function(){return this};function E(t,e,r,n){var i=t===0?e:t===1?r:[e,r];return n?n.value=i:n={value:i,done:!1},n}function D(){return{value:void 0,done:!0}}function Yr(t){return Array.isArray(t)?!0:!!fe(t)}function pr(t){return t&&typeof t.next=="function"}function be(t){var e=fe(t);return e&&e.call(t)}function fe(t){var e=t&&(Oe&&t[Oe]||t[Wr]);if(typeof e=="function")return e}function Nn(t){var e=fe(t);return e&&e===t.entries}function Cn(t){var e=fe(t);return e&&e===t.keys}var It=Object.prototype.hasOwnProperty;function Hr(t){return Array.isArray(t)||typeof t=="string"?!0:t&&typeof t=="object"&&Number.isInteger(t.length)&&t.length>=0&&(t.length===0?Object.keys(t).length===1:t.hasOwnProperty(t.length-1))}var B=function(t){function e(r){return r==null?$e():V(r)?r.toSeq():xn(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq {","}")},e.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},e.prototype.__iterate=function(n,i){var o=this._cache;if(o){for(var a=o.length,s=0;s!==a;){var u=o[i?a-++s:s++];if(n(u[1],u[0],this)===!1)break}return s}return this.__iterateUncached(n,i)},e.prototype.__iterator=function(n,i){var o=this._cache;if(o){var a=o.length,s=0;return new y(function(){if(s===a)return D();var u=o[i?a-++s:s++];return E(n,u[0],u[1])})}return this.__iteratorUncached(n,i)},e}(b),ut=function(t){function e(r){return r==null?$e().toKeyedSeq():j(r)?O(r)?r.toSeq():r.fromEntrySeq():Mt(r)?r.toSeq():je(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toKeyedSeq=function(){return this},e}(B),X=function(t){function e(r){return r==null?$e():j(r)?O(r)?r.entrySeq():r.toIndexedSeq():Mt(r)?r.toSeq().entrySeq():Jr(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toIndexedSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq [","]")},e}(B),Rt=function(t){function e(r){return(j(r)&&!se(r)?r:X(r)).toSetSeq()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toSetSeq=function(){return this},e}(B);B.isSeq=ke;B.Keyed=ut;B.Set=Rt;B.Indexed=X;B.prototype[Ur]=!0;var pt=function(t){function e(r){this._array=r,this.size=r.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return this.has(n)?this._array[at(this,n)]:i},e.prototype.__iterate=function(n,i){for(var o=this._array,a=o.length,s=0;s!==a;){var u=i?a-++s:s++;if(n(o[u],u,this)===!1)break}return s},e.prototype.__iterator=function(n,i){var o=this._array,a=o.length,s=0;return new y(function(){if(s===a)return D();var u=i?a-++s:s++;return E(n,u,o[u])})},e}(X),Le=function(t){function e(r){var n=Object.keys(r).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[]);this._object=r,this._keys=n,this.size=n.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},e.prototype.has=function(n){return It.call(this._object,n)},e.prototype.__iterate=function(n,i){for(var o=this._object,a=this._keys,s=a.length,u=0;u!==s;){var f=a[i?s-++u:u++];if(n(o[f],f,this)===!1)break}return u},e.prototype.__iterator=function(n,i){var o=this._object,a=this._keys,s=a.length,u=0;return new y(function(){if(u===s)return D();var f=a[i?s-++u:u++];return E(n,f,o[f])})},e}(ut);Le.prototype[zt]=!0;var Bn=function(t){function e(r){this._collection=r,this.size=r.length||r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var o=this._collection,a=be(o),s=0;if(pr(a))for(var u;!(u=a.next()).done&&n(u.value,s++,this)!==!1;);return s},e.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var o=this._collection,a=be(o);if(!pr(a))return new y(D);var s=0;return new y(function(){var u=a.next();return u.done?u:E(n,s++,u.value)})},e}(X),_r;function $e(){return _r||(_r=new pt([]))}function je(t){var e=De(t);if(e)return e.fromEntrySeq();if(typeof t=="object")return new Le(t);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+t)}function Jr(t){var e=De(t);if(e)return e;throw new TypeError("Expected Array or collection object of values: "+t)}function xn(t){var e=De(t);if(e)return Nn(t)?e.fromEntrySeq():Cn(t)?e.toSetSeq():e;if(typeof t=="object")return new Le(t);throw new TypeError("Expected Array or collection object of values, or keyed object: "+t)}function De(t){return Hr(t)?new pt(t):Yr(t)?new Bn(t):void 0}var Xr="@@__IMMUTABLE_MAP__@@";function Ne(t){return Boolean(t&&t[Xr])}function Zr(t){return Ne(t)&&H(t)}function lr(t){return Boolean(t&&typeof t.equals=="function"&&typeof t.hashCode=="function")}function R(t,e){if(t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1;if(typeof t.valueOf=="function"&&typeof e.valueOf=="function"){if(t=t.valueOf(),e=e.valueOf(),t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1}return!!(lr(t)&&lr(e)&&t.equals(e))}var Lt=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(e,r){e|=0,r|=0;var n=e&65535,i=r&65535;return n*i+((e>>>16)*i+n*(r>>>16)<<16>>>0)|0};function he(t){return t>>>1&1073741824|t&3221225471}var Kn=Object.prototype.valueOf;function C(t){if(t==null)return dr(t);if(typeof t.hashCode=="function")return he(t.hashCode(t));var e=Hn(t);if(e==null)return dr(e);switch(typeof e){case"boolean":return e?1108378657:1108378656;case"number":return Pn(e);case"string":return e.length>Jn?Un(e):Me(e);case"object":case"function":return Wn(e);case"symbol":return Fn(e);default:if(typeof e.toString=="function")return Me(e.toString());throw new Error("Value type "+typeof e+" cannot be hashed.")}}function dr(t){return t===null?1108378658:1108378659}function Pn(t){if(t!==t||t===1/0)return 0;var e=t|0;for(e!==t&&(e^=t*4294967295);t>4294967295;)t/=4294967295,e^=t;return he(e)}function Un(t){var e=ge[t];return e===void 0&&(e=Me(t),me===Xn&&(me=0,ge={}),me++,ge[t]=e),e}function Me(t){for(var e=0,r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return he(e)}function Fn(t){var e=mr[t];return e!==void 0||(e=Gr(),mr[t]=e),e}function Wn(t){var e;if(ze&&(e=Ie.get(t),e!==void 0)||(e=t[ct],e!==void 0)||!yr&&(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[ct],e!==void 0||(e=Yn(t),e!==void 0)))return e;if(e=Gr(),ze)Ie.set(t,e);else{if(vr!==void 0&&vr(t)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(yr)Object.defineProperty(t,ct,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(t.propertyIsEnumerable!==void 0&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[ct]=e;else if(t.nodeType!==void 0)t[ct]=e;else throw new Error("Unable to set a non-enumerable property on object.")}return e}var vr=Object.isExtensible,yr=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function Yn(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}function Hn(t){return t.valueOf!==Kn&&typeof t.valueOf=="function"?t.valueOf(t):t}function Gr(){var t=++ye;return ye&1073741824&&(ye=0),t}var ze=typeof WeakMap=="function",Ie;ze&&(Ie=new WeakMap);var mr=Object.create(null),ye=0,ct="__immutablehash__";typeof Symbol=="function"&&(ct=Symbol(ct));var Jn=16,Xn=255,me=0,ge={},ce=function(t){function e(r,n){this._iter=r,this._useKeys=n,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n,i){return this._iter.get(n,i)},e.prototype.has=function(n){return this._iter.has(n)},e.prototype.valueSeq=function(){return this._iter.valueSeq()},e.prototype.reverse=function(){var n=this,i=Ce(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},e.prototype.map=function(n,i){var o=this,a=rn(this,n,i);return this._useKeys||(a.valueSeq=function(){return o._iter.toSeq().map(n,i)}),a},e.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(a,s){return n(a,s,o)},i)},e.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},e}(ut);ce.prototype[zt]=!0;var Qr=function(t){function e(r){this._iter=r,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.includes=function(n){return this._iter.includes(n)},e.prototype.__iterate=function(n,i){var o=this,a=0;return i&&yt(this),this._iter.__iterate(function(s){return n(s,i?o.size-++a:a++,o)},i)},e.prototype.__iterator=function(n,i){var o=this,a=this._iter.__iterator(J,i),s=0;return i&&yt(this),new y(function(){var u=a.next();return u.done?u:E(n,i?o.size-++s:s++,u.value,u)})},e}(X),Vr=function(t){function e(r){this._iter=r,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.has=function(n){return this._iter.includes(n)},e.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(a){return n(a,a,o)},i)},e.prototype.__iterator=function(n,i){var o=this._iter.__iterator(J,i);return new y(function(){var a=o.next();return a.done?a:E(n,a.value,a.value,a)})},e}(Rt),tn=function(t){function e(r){this._iter=r,this.size=r.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.entrySeq=function(){return this._iter.toSeq()},e.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(a){if(a){Sr(a);var s=j(a);return n(s?a.get(1):a[1],s?a.get(0):a[0],o)}},i)},e.prototype.__iterator=function(n,i){var o=this._iter.__iterator(J,i);return new y(function(){for(;;){var a=o.next();if(a.done)return a;var s=a.value;if(s){Sr(s);var u=j(s);return E(n,u?s.get(0):s[0],u?s.get(1):s[1],a)}}})},e}(ut);Qr.prototype.cacheResult=ce.prototype.cacheResult=Vr.prototype.cacheResult=tn.prototype.cacheResult=xe;function en(t){var e=tt(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var r=t.reverse.apply(this);return r.flip=function(){return t.reverse()},r},e.has=function(r){return t.includes(r)},e.includes=function(r){return t.has(r)},e.cacheResult=xe,e.__iterateUncached=function(r,n){var i=this;return t.__iterate(function(o,a){return r(a,o,i)!==!1},n)},e.__iteratorUncached=function(r,n){if(r===U){var i=t.__iterator(r,n);return new y(function(){var o=i.next();if(!o.done){var a=o.value[0];o.value[0]=o.value[1],o.value[1]=a}return o})}return t.__iterator(r===J?Yt:J,n)},e}function rn(t,e,r){var n=tt(t);return n.size=t.size,n.has=function(i){return t.has(i)},n.get=function(i,o){var a=t.get(i,v);return a===v?o:e.call(r,a,i,t)},n.__iterateUncached=function(i,o){var a=this;return t.__iterate(function(s,u,f){return i(e.call(r,s,u,f),u,a)!==!1},o)},n.__iteratorUncached=function(i,o){var a=t.__iterator(U,o);return new y(function(){var s=a.next();if(s.done)return s;var u=s.value,f=u[0];return E(i,f,e.call(r,u[1],f,t),s)})},n}function Ce(t,e){var r=this,n=tt(t);return n._iter=t,n.size=t.size,n.reverse=function(){return t},t.flip&&(n.flip=function(){var i=en(t);return i.reverse=function(){return t.flip()},i}),n.get=function(i,o){return t.get(e?i:-1-i,o)},n.has=function(i){return t.has(e?i:-1-i)},n.includes=function(i){return t.includes(i)},n.cacheResult=xe,n.__iterate=function(i,o){var a=this,s=0;return o&&yt(t),t.__iterate(function(u,f){return i(u,e?f:o?a.size-++s:s++,a)},!o)},n.__iterator=function(i,o){var a=0;o&&yt(t);var s=t.__iterator(U,!o);return new y(function(){var u=s.next();if(u.done)return u;var f=u.value;return E(i,e?f[0]:o?r.size-++a:a++,f[1],u)})},n}function nn(t,e,r,n){var i=tt(t);return n&&(i.has=function(o){var a=t.get(o,v);return a!==v&&!!e.call(r,a,o,t)},i.get=function(o,a){var s=t.get(o,v);return s!==v&&e.call(r,s,o,t)?s:a}),i.__iterateUncached=function(o,a){var s=this,u=0;return t.__iterate(function(f,h,c){if(e.call(r,f,h,c))return u++,o(f,n?h:u-1,s)},a),u},i.__iteratorUncached=function(o,a){var s=t.__iterator(U,a),u=0;return new y(function(){for(;;){var f=s.next();if(f.done)return f;var h=f.value,c=h[0],p=h[1];if(e.call(r,p,c,t))return E(o,n?c:u++,p,f)}})},i}function Zn(t,e,r){var n=Z().asMutable();return t.__iterate(function(i,o){n.update(e.call(r,i,o,t),0,function(a){return a+1})}),n.asImmutable()}function Gn(t,e,r){var n=O(t),i=(H(t)?nt():Z()).asMutable();t.__iterate(function(a,s){i.update(e.call(r,a,s,t),function(u){return u=u||[],u.push(n?[s,a]:a),u})});var o=sn(t);return i.map(function(a){return m(t,o(a))}).asImmutable()}function Be(t,e,r,n){var i=t.size;if(oe(e,r,i))return t;var o=Wt(e,i),a=ae(r,i);if(o!==o||a!==a)return Be(t.toSeq().cacheResult(),e,r,n);var s=a-o,u;s===s&&(u=s<0?0:s);var f=tt(t);return f.size=u===0?u:t.size&&u||void 0,!n&&ke(t)&&u>=0&&(f.get=function(h,c){return h=at(this,h),h>=0&&h<u?t.get(h+o,c):c}),f.__iterateUncached=function(h,c){var p=this;if(u===0)return 0;if(c)return this.cacheResult().__iterate(h,c);var l=0,_=!0,d=0;return t.__iterate(function(N,G){if(!(_&&(_=l++<o)))return d++,h(N,n?G:d-1,p)!==!1&&d!==u}),d},f.__iteratorUncached=function(h,c){if(u!==0&&c)return this.cacheResult().__iterator(h,c);if(u===0)return new y(D);var p=t.__iterator(h,c),l=0,_=0;return new y(function(){for(;l++<o;)p.next();if(++_>u)return D();var d=p.next();return n||h===J||d.done?d:h===Yt?E(h,_-1,void 0,d):E(h,_-1,d.value[1],d)})},f}function Qn(t,e,r){var n=tt(t);return n.__iterateUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterate(i,o);var s=0;return t.__iterate(function(u,f,h){return e.call(r,u,f,h)&&++s&&i(u,f,a)}),s},n.__iteratorUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterator(i,o);var s=t.__iterator(U,o),u=!0;return new y(function(){if(!u)return D();var f=s.next();if(f.done)return f;var h=f.value,c=h[0],p=h[1];return e.call(r,p,c,a)?i===U?f:E(i,c,p,f):(u=!1,D())})},n}function on(t,e,r,n){var i=tt(t);return i.__iterateUncached=function(o,a){var s=this;if(a)return this.cacheResult().__iterate(o,a);var u=!0,f=0;return t.__iterate(function(h,c,p){if(!(u&&(u=e.call(r,h,c,p))))return f++,o(h,n?c:f-1,s)}),f},i.__iteratorUncached=function(o,a){var s=this;if(a)return this.cacheResult().__iterator(o,a);var u=t.__iterator(U,a),f=!0,h=0;return new y(function(){var c,p,l;do{if(c=u.next(),c.done)return n||o===J?c:o===Yt?E(o,h++,void 0,c):E(o,h++,c.value[1],c);var _=c.value;p=_[0],l=_[1],f&&(f=e.call(r,l,p,s))}while(f);return o===U?c:E(o,p,l,c)})},i}function Vn(t,e){var r=O(t),n=[t].concat(e).map(function(a){return j(a)?r&&(a=F(a)):a=r?je(a):Jr(Array.isArray(a)?a:[a]),a}).filter(function(a){return a.size!==0});if(n.length===0)return t;if(n.length===1){var i=n[0];if(i===t||r&&O(i)||$(t)&&$(i))return i}var o=new pt(n);return r?o=o.toKeyedSeq():$(t)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=n.reduce(function(a,s){if(a!==void 0){var u=s.size;if(u!==void 0)return a+u}},0),o}function an(t,e,r){var n=tt(t);return n.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var a=0,s=!1;function u(f,h){f.__iterate(function(c,p){return(!e||h<e)&&j(c)?u(c,h+1):(a++,i(c,r?p:a-1,n)===!1&&(s=!0)),!s},o)}return u(t,0),a},n.__iteratorUncached=function(i,o){if(o)return this.cacheResult().__iterator(i,o);var a=t.__iterator(i,o),s=[],u=0;return new y(function(){for(;a;){var f=a.next();if(f.done!==!1){a=s.pop();continue}var h=f.value;if(i===U&&(h=h[1]),(!e||s.length<e)&&j(h))s.push(a),a=h.__iterator(i,o);else return r?f:E(i,u++,h,f)}return D()})},n}function ti(t,e,r){var n=sn(t);return t.toSeq().map(function(i,o){return n(e.call(r,i,o,t))}).flatten(!0)}function ei(t,e){var r=tt(t);return r.size=t.size&&t.size*2-1,r.__iterateUncached=function(n,i){var o=this,a=0;return t.__iterate(function(s){return(!a||n(e,a++,o)!==!1)&&n(s,a++,o)!==!1},i),a},r.__iteratorUncached=function(n,i){var o=t.__iterator(J,i),a=0,s;return new y(function(){return(!s||a%2)&&(s=o.next(),s.done)?s:a%2?E(n,a++,e):E(n,a++,s.value,s)})},r}function mt(t,e,r){e||(e=un);var n=O(t),i=0,o=t.toSeq().map(function(a,s){return[s,a,i++,r?r(a,s,t):a]}).valueSeq().toArray();return o.sort(function(a,s){return e(a[3],s[3])||a[2]-s[2]}).forEach(n?function(a,s){o[s].length=2}:function(a,s){o[s]=a[1]}),n?ut(o):$(t)?X(o):Rt(o)}function Gt(t,e,r){if(e||(e=un),r){var n=t.toSeq().map(function(i,o){return[i,r(i,o,t)]}).reduce(function(i,o){return gr(e,i[1],o[1])?o:i});return n&&n[0]}return t.reduce(function(i,o){return gr(e,i,o)?o:i})}function gr(t,e,r){var n=t(r,e);return n===0&&r!==e&&(r==null||r!==r)||n>0}function Qt(t,e,r,n){var i=tt(t),o=new pt(r).map(function(a){return a.size});return i.size=n?o.max():o.min(),i.__iterate=function(a,s){for(var u=this.__iterator(J,s),f,h=0;!(f=u.next()).done&&a(f.value,h++,this)!==!1;);return h},i.__iteratorUncached=function(a,s){var u=r.map(function(c){return c=b(c),be(s?c.reverse():c)}),f=0,h=!1;return new y(function(){var c;return h||(c=u.map(function(p){return p.next()}),h=n?c.every(function(p){return p.done}):c.some(function(p){return p.done})),h?D():E(a,f++,e.apply(null,c.map(function(p){return p.value})))})},i}function m(t,e){return t===e?t:ke(t)?e:t.constructor(e)}function Sr(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function sn(t){return O(t)?F:$(t)?_t:bt}function tt(t){return Object.create((O(t)?ut:$(t)?X:Rt).prototype)}function xe(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):B.prototype.cacheResult.call(this)}function un(t,e){return t===void 0&&e===void 0?0:t===void 0?1:e===void 0?-1:t>e?1:t<e?-1:0}function Q(t,e){e=e||0;for(var r=Math.max(0,t.length-e),n=new Array(r),i=0;i<r;i++)n[i]=t[i+e];return n}function Ke(t,e){if(!t)throw new Error(e)}function P(t){Ke(t!==1/0,"Cannot perform this action with an infinite size.")}function fn(t){if(Hr(t)&&typeof t!="string")return t;if(H(t))return t.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+t)}var ri=Object.prototype.toString;function ni(t){if(!t||typeof t!="object"||ri.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var r=e,n=Object.getPrototypeOf(e);n!==null;)r=n,n=Object.getPrototypeOf(r);return r===e}function st(t){return typeof t=="object"&&(V(t)||Array.isArray(t)||ni(t))}function Ct(t){try{return typeof t=="string"?JSON.stringify(t):String(t)}catch{return JSON.stringify(t)}}function ii(t,e){return V(t)?t.has(e):st(t)&&It.call(t,e)}function hn(t,e,r){return V(t)?t.get(e,r):ii(t,e)?typeof t.get=="function"?t.get(e):t[e]:r}function ne(t){if(Array.isArray(t))return Q(t);var e={};for(var r in t)It.call(t,r)&&(e[r]=t[r]);return e}function oi(t,e){if(!st(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(V(t)){if(!t.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+t);return t.remove(e)}if(!It.call(t,e))return t;var r=ne(t);return Array.isArray(r)?r.splice(e,1):delete r[e],r}function ai(t,e,r){if(!st(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(V(t)){if(!t.set)throw new TypeError("Cannot update immutable value without .set() method: "+t);return t.set(e,r)}if(It.call(t,e)&&r===t[e])return t;var n=ne(t);return n[e]=r,n}function Tt(t,e,r,n){n||(n=r,r=void 0);var i=cn(V(t),t,fn(e),0,r,n);return i===v?r:i}function cn(t,e,r,n,i,o){var a=e===v;if(n===r.length){var s=a?i:e,u=o(s);return u===s?e:u}if(!a&&!st(e))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(Ct)+"]: "+e);var f=r[n],h=a?v:hn(e,f,v),c=cn(h===v?t:V(h),h,r,n+1,i,o);return c===h?e:c===v?oi(e,f):ai(a?t?Y():{}:e,f,c)}function si(t,e,r){return Tt(t,e,v,function(){return r})}function Pe(t,e){return si(this,t,e)}function ui(t,e){return Tt(t,e,function(){return v})}function Ue(t){return ui(this,t)}function pn(t,e,r,n){return Tt(t,[e],r,n)}function Fe(t,e,r){return arguments.length===1?t(this):pn(this,t,e,r)}function We(t,e,r){return Tt(this,t,e,r)}function _n(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return dn(this,t)}function ln(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(typeof t!="function")throw new TypeError("Invalid merger function: "+t);return dn(this,e,t)}function dn(t,e,r){for(var n=[],i=0;i<e.length;i++){var o=F(e[i]);o.size!==0&&n.push(o)}return n.length===0?t:t.toSeq().size===0&&!t.__ownerID&&n.length===1?t.constructor(n[0]):t.withMutations(function(a){for(var s=r?function(f,h){pn(a,h,v,function(c){return c===v?f:r(c,f,h)})}:function(f,h){a.set(h,f)},u=0;u<n.length;u++)n[u].forEach(s)})}function Ye(t,e,r){return He(t,e,fi(r))}function He(t,e,r){if(!st(t))throw new TypeError("Cannot merge into non-data-structure value: "+t);if(V(t))return typeof r=="function"&&t.mergeWith?t.mergeWith.apply(t,[r].concat(e)):t.merge?t.merge.apply(t,e):t.concat.apply(t,e);for(var n=Array.isArray(t),i=t,o=n?_t:F,a=n?function(u){i===t&&(i=ne(i)),i.push(u)}:function(u,f){var h=It.call(i,f),c=h&&r?r(i[f],u,f):u;(!h||c!==i[f])&&(i===t&&(i=ne(i)),i[f]=c)},s=0;s<e.length;s++)o(e[s]).forEach(a);return i}function fi(t){function e(r,n,i){return st(r)&&st(n)&&hi(r,n)?He(r,[n],e):t?t(r,n,i):n}return e}function hi(t,e){var r=B(t),n=B(e);return $(r)===$(n)&&O(r)===O(n)}function vn(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Ye(this,t)}function yn(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Ye(this,e,t)}function Je(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Tt(this,t,Y(),function(n){return He(n,e)})}function Xe(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Tt(this,t,Y(),function(n){return Ye(n,e)})}function Ht(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this}function Jt(){return this.__ownerID?this:this.__ensureOwner(new Ae)}function Xt(){return this.__ensureOwner()}function Ze(){return this.__altered}var Z=function(t){function e(r){return r==null?Y():Ne(r)&&!H(r)?r:Y().withMutations(function(n){var i=t(r);P(i.size),i.forEach(function(o,a){return n.set(a,o)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return Y().withMutations(function(o){for(var a=0;a<n.length;a+=2){if(a+1>=n.length)throw new Error("Missing value for key: "+n[a]);o.set(n[a],n[a+1])}})},e.prototype.toString=function(){return this.__toString("Map {","}")},e.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},e.prototype.set=function(n,i){return Or(this,n,i)},e.prototype.remove=function(n){return Or(this,n,v)},e.prototype.deleteAll=function(n){var i=b(n);return i.size===0?this:this.withMutations(function(o){i.forEach(function(a){return o.remove(a)})})},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Y()},e.prototype.sort=function(n){return nt(mt(this,n))},e.prototype.sortBy=function(n,i){return nt(mt(this,i,n))},e.prototype.map=function(n,i){var o=this;return this.withMutations(function(a){a.forEach(function(s,u){a.set(u,n.call(i,s,u,o))})})},e.prototype.__iterator=function(n,i){return new ci(this,n,i)},e.prototype.__iterate=function(n,i){var o=this,a=0;return this._root&&this._root.iterate(function(s){return a++,n(s[1],s[0],o)},i),a},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Ge(this.size,this._root,n,this.__hash):this.size===0?Y():(this.__ownerID=n,this.__altered=!1,this)},e}(F);Z.isMap=Ne;var w=Z.prototype;w[Xr]=!0;w[Ft]=w.remove;w.removeAll=w.deleteAll;w.setIn=Pe;w.removeIn=w.deleteIn=Ue;w.update=Fe;w.updateIn=We;w.merge=w.concat=_n;w.mergeWith=ln;w.mergeDeep=vn;w.mergeDeepWith=yn;w.mergeIn=Je;w.mergeDeepIn=Xe;w.withMutations=Ht;w.wasAltered=Ze;w.asImmutable=Xt;w["@@transducer/init"]=w.asMutable=Jt;w["@@transducer/step"]=function(t,e){return t.set(e[0],e[1])};w["@@transducer/result"]=function(t){return t.asImmutable()};var Bt=function(e,r){this.ownerID=e,this.entries=r};Bt.prototype.get=function(e,r,n,i){for(var o=this.entries,a=0,s=o.length;a<s;a++)if(R(n,o[a][0]))return o[a][1];return i};Bt.prototype.update=function(e,r,n,i,o,a,s){for(var u=o===v,f=this.entries,h=0,c=f.length;h<c&&!R(i,f[h][0]);h++);var p=h<c;if(p?f[h][1]===o:u)return this;if(K(s),(u||!p)&&K(a),!(u&&f.length===1)){if(!p&&!u&&f.length>=yi)return pi(e,f,i,o);var l=e&&e===this.ownerID,_=l?f:Q(f);return p?u?h===c-1?_.pop():_[h]=_.pop():_[h]=[i,o]:_.push([i,o]),l?(this.entries=_,this):new Bt(e,_)}};var gt=function(e,r,n){this.ownerID=e,this.bitmap=r,this.nodes=n};gt.prototype.get=function(e,r,n,i){r===void 0&&(r=C(n));var o=1<<((e===0?r:r>>>e)&A),a=this.bitmap;return(a&o)===0?i:this.nodes[mn(a&o-1)].get(e+S,r,n,i)};gt.prototype.update=function(e,r,n,i,o,a,s){n===void 0&&(n=C(i));var u=(r===0?n:n>>>r)&A,f=1<<u,h=this.bitmap,c=(h&f)!==0;if(!c&&o===v)return this;var p=mn(h&f-1),l=this.nodes,_=c?l[p]:void 0,d=Qe(_,e,r+S,n,i,o,a,s);if(d===_)return this;if(!c&&d&&l.length>=mi)return li(e,l,h,u,d);if(c&&!d&&l.length===2&&br(l[p^1]))return l[p^1];if(c&&d&&l.length===1&&br(d))return d;var N=e&&e===this.ownerID,G=c?d?h:h^f:h|f,ht=c?d?gn(l,p,d,N):vi(l,p,N):di(l,p,d,N);return N?(this.bitmap=G,this.nodes=ht,this):new gt(e,G,ht)};var xt=function(e,r,n){this.ownerID=e,this.count=r,this.nodes=n};xt.prototype.get=function(e,r,n,i){r===void 0&&(r=C(n));var o=(e===0?r:r>>>e)&A,a=this.nodes[o];return a?a.get(e+S,r,n,i):i};xt.prototype.update=function(e,r,n,i,o,a,s){n===void 0&&(n=C(i));var u=(r===0?n:n>>>r)&A,f=o===v,h=this.nodes,c=h[u];if(f&&!c)return this;var p=Qe(c,e,r+S,n,i,o,a,s);if(p===c)return this;var l=this.count;if(!c)l++;else if(!p&&(l--,l<gi))return _i(e,h,l,u);var _=e&&e===this.ownerID,d=gn(h,u,p,_);return _?(this.count=l,this.nodes=d,this):new xt(e,l,d)};var St=function(e,r,n){this.ownerID=e,this.keyHash=r,this.entries=n};St.prototype.get=function(e,r,n,i){for(var o=this.entries,a=0,s=o.length;a<s;a++)if(R(n,o[a][0]))return o[a][1];return i};St.prototype.update=function(e,r,n,i,o,a,s){n===void 0&&(n=C(i));var u=o===v;if(n!==this.keyHash)return u?this:(K(s),K(a),Ve(this,e,r,n,[i,o]));for(var f=this.entries,h=0,c=f.length;h<c&&!R(i,f[h][0]);h++);var p=h<c;if(p?f[h][1]===o:u)return this;if(K(s),(u||!p)&&K(a),u&&c===2)return new rt(e,this.keyHash,f[h^1]);var l=e&&e===this.ownerID,_=l?f:Q(f);return p?u?h===c-1?_.pop():_[h]=_.pop():_[h]=[i,o]:_.push([i,o]),l?(this.entries=_,this):new St(e,this.keyHash,_)};var rt=function(e,r,n){this.ownerID=e,this.keyHash=r,this.entry=n};rt.prototype.get=function(e,r,n,i){return R(n,this.entry[0])?this.entry[1]:i};rt.prototype.update=function(e,r,n,i,o,a,s){var u=o===v,f=R(i,this.entry[0]);if(f?o===this.entry[1]:u)return this;if(K(s),u){K(a);return}return f?e&&e===this.ownerID?(this.entry[1]=o,this):new rt(e,this.keyHash,[i,o]):(K(a),Ve(this,e,r,C(i),[i,o]))};Bt.prototype.iterate=St.prototype.iterate=function(t,e){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(t(r[e?i-n:n])===!1)return!1};gt.prototype.iterate=xt.prototype.iterate=function(t,e){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[e?i-n:n];if(o&&o.iterate(t,e)===!1)return!1}};rt.prototype.iterate=function(t,e){return t(this.entry)};var ci=function(t){function e(r,n,i){this._type=n,this._reverse=i,this._stack=r._root&&wr(r._root)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var o=i.node,a=i.index++,s=void 0;if(o.entry){if(a===0)return Se(n,o.entry)}else if(o.entries){if(s=o.entries.length-1,a<=s)return Se(n,o.entries[this._reverse?s-a:a])}else if(s=o.nodes.length-1,a<=s){var u=o.nodes[this._reverse?s-a:a];if(u){if(u.entry)return Se(n,u.entry);i=this._stack=wr(u,i)}continue}i=this._stack=this._stack.__prev}return D()},e}(y);function Se(t,e){return E(t,e[0],e[1])}function wr(t,e){return{node:t,index:0,__prev:e}}function Ge(t,e,r,n){var i=Object.create(w);return i.size=t,i._root=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var Er;function Y(){return Er||(Er=Ge(0))}function Or(t,e,r){var n,i;if(t._root){var o=Ee(),a=Ee();if(n=Qe(t._root,t.__ownerID,0,void 0,e,r,o,a),!a.value)return t;i=t.size+(o.value?r===v?-1:1:0)}else{if(r===v)return t;i=1,n=new Bt(t.__ownerID,[[e,r]])}return t.__ownerID?(t.size=i,t._root=n,t.__hash=void 0,t.__altered=!0,t):n?Ge(i,n):Y()}function Qe(t,e,r,n,i,o,a,s){return t?t.update(e,r,n,i,o,a,s):o===v?t:(K(s),K(a),new rt(e,n,[i,o]))}function br(t){return t.constructor===rt||t.constructor===St}function Ve(t,e,r,n,i){if(t.keyHash===n)return new St(e,n,[t.entry,i]);var o=(r===0?t.keyHash:t.keyHash>>>r)&A,a=(r===0?n:n>>>r)&A,s,u=o===a?[Ve(t,e,r+S,n,i)]:(s=new rt(e,n,i),o<a?[t,s]:[s,t]);return new gt(e,1<<o|1<<a,u)}function pi(t,e,r,n){t||(t=new Ae);for(var i=new rt(t,C(r),[r,n]),o=0;o<e.length;o++){var a=e[o];i=i.update(t,0,void 0,a[0],a[1])}return i}function _i(t,e,r,n){for(var i=0,o=0,a=new Array(r),s=0,u=1,f=e.length;s<f;s++,u<<=1){var h=e[s];h!==void 0&&s!==n&&(i|=u,a[o++]=h)}return new gt(t,i,a)}function li(t,e,r,n,i){for(var o=0,a=new Array(x),s=0;r!==0;s++,r>>>=1)a[s]=r&1?e[o++]:void 0;return a[n]=i,new xt(t,o+1,a)}function mn(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,t&127}function gn(t,e,r,n){var i=n?t:Q(t);return i[e]=r,i}function di(t,e,r,n){var i=t.length+1;if(n&&e+1===i)return t[e]=r,t;for(var o=new Array(i),a=0,s=0;s<i;s++)s===e?(o[s]=r,a=-1):o[s]=t[s+a];return o}function vi(t,e,r){var n=t.length-1;if(r&&e===n)return t.pop(),t;for(var i=new Array(n),o=0,a=0;a<n;a++)a===e&&(o=1),i[a]=t[a+o];return i}var yi=x/4,mi=x/2,gi=x/4,Sn="@@__IMMUTABLE_LIST__@@";function wn(t){return Boolean(t&&t[Sn])}var et=function(t){function e(r){var n=re();if(r==null)return n;if(wn(r))return r;var i=t(r),o=i.size;return o===0?n:(P(o),o>0&&o<x?Kt(0,o,S,null,new ot(i.toArray())):n.withMutations(function(a){a.setSize(o),i.forEach(function(s,u){return a.set(u,s)})}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("List [","]")},e.prototype.get=function(n,i){if(n=at(this,n),n>=0&&n<this.size){n+=this._origin;var o=En(this,n);return o&&o.array[n&A]}return i},e.prototype.set=function(n,i){return Si(this,n,i)},e.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},e.prototype.insert=function(n,i){return this.splice(n,0,i)},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=S,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):re()},e.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(o){it(o,0,i+n.length);for(var a=0;a<n.length;a++)o.set(i+a,n[a])})},e.prototype.pop=function(){return it(this,0,-1)},e.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){it(i,-n.length);for(var o=0;o<n.length;o++)i.set(o,n[o])})},e.prototype.shift=function(){return it(this,1)},e.prototype.concat=function(){for(var n=arguments,i=[],o=0;o<arguments.length;o++){var a=n[o],s=t(typeof a!="string"&&Yr(a)?a:[a]);s.size!==0&&i.push(s)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(u){i.forEach(function(f){return f.forEach(function(h){return u.push(h)})})})},e.prototype.setSize=function(n){return it(this,0,n)},e.prototype.map=function(n,i){var o=this;return this.withMutations(function(a){for(var s=0;s<o.size;s++)a.set(s,n.call(i,a.get(s),s,o))})},e.prototype.slice=function(n,i){var o=this.size;return oe(n,i,o)?this:it(this,Wt(n,o),ae(i,o))},e.prototype.__iterator=function(n,i){var o=i?this.size:0,a=Mr(this,i);return new y(function(){var s=a();return s===Nt?D():E(n,i?--o:o++,s)})},e.prototype.__iterate=function(n,i){for(var o=i?this.size:0,a=Mr(this,i),s;(s=a())!==Nt&&n(s,i?--o:o++,this)!==!1;);return o},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Kt(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?re():(this.__ownerID=n,this.__altered=!1,this)},e}(_t);et.isList=wn;var M=et.prototype;M[Sn]=!0;M[Ft]=M.remove;M.merge=M.concat;M.setIn=Pe;M.deleteIn=M.removeIn=Ue;M.update=Fe;M.updateIn=We;M.mergeIn=Je;M.mergeDeepIn=Xe;M.withMutations=Ht;M.wasAltered=Ze;M.asImmutable=Xt;M["@@transducer/init"]=M.asMutable=Jt;M["@@transducer/step"]=function(t,e){return t.push(e)};M["@@transducer/result"]=function(t){return t.asImmutable()};var ot=function(e,r){this.array=e,this.ownerID=r};ot.prototype.removeBefore=function(e,r,n){if(n===r?1<<r:this.array.length===0)return this;var i=n>>>r&A;if(i>=this.array.length)return new ot([],e);var o=i===0,a;if(r>0){var s=this.array[i];if(a=s&&s.removeBefore(e,r-S,n),a===s&&o)return this}if(o&&!a)return this;var u=wt(this,e);if(!o)for(var f=0;f<i;f++)u.array[f]=void 0;return a&&(u.array[i]=a),u};ot.prototype.removeAfter=function(e,r,n){if(n===(r?1<<r:0)||this.array.length===0)return this;var i=n-1>>>r&A;if(i>=this.array.length)return this;var o;if(r>0){var a=this.array[i];if(o=a&&a.removeAfter(e,r-S,n),o===a&&i===this.array.length-1)return this}var s=wt(this,e);return s.array.splice(i+1),o&&(s.array[i]=o),s};var Nt={};function Mr(t,e){var r=t._origin,n=t._capacity,i=Pt(n),o=t._tail;return a(t._root,t._level,0);function a(f,h,c){return h===0?s(f,c):u(f,h,c)}function s(f,h){var c=h===i?o&&o.array:f&&f.array,p=h>r?0:r-h,l=n-h;return l>x&&(l=x),function(){if(p===l)return Nt;var _=e?--l:p++;return c&&c[_]}}function u(f,h,c){var p,l=f&&f.array,_=c>r?0:r-c>>h,d=(n-c>>h)+1;return d>x&&(d=x),function(){for(;;){if(p){var N=p();if(N!==Nt)return N;p=null}if(_===d)return Nt;var G=e?--d:_++;p=a(l&&l[G],h-S,c+(G<<h))}}}}function Kt(t,e,r,n,i,o,a){var s=Object.create(M);return s.size=e-t,s._origin=t,s._capacity=e,s._level=r,s._root=n,s._tail=i,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}var zr;function re(){return zr||(zr=Kt(0,0,S))}function Si(t,e,r){if(e=at(t,e),e!==e)return t;if(e>=t.size||e<0)return t.withMutations(function(a){e<0?it(a,e).set(0,r):it(a,0,e+1).set(e,r)});e+=t._origin;var n=t._tail,i=t._root,o=Ee();return e>=Pt(t._capacity)?n=Re(n,t.__ownerID,0,e,r,o):i=Re(i,t.__ownerID,t._level,e,r,o),o.value?t.__ownerID?(t._root=i,t._tail=n,t.__hash=void 0,t.__altered=!0,t):Kt(t._origin,t._capacity,t._level,i,n):t}function Re(t,e,r,n,i,o){var a=n>>>r&A,s=t&&a<t.array.length;if(!s&&i===void 0)return t;var u;if(r>0){var f=t&&t.array[a],h=Re(f,e,r-S,n,i,o);return h===f?t:(u=wt(t,e),u.array[a]=h,u)}return s&&t.array[a]===i?t:(o&&K(o),u=wt(t,e),i===void 0&&a===u.array.length-1?u.array.pop():u.array[a]=i,u)}function wt(t,e){return e&&t&&e===t.ownerID?t:new ot(t?t.array.slice():[],e)}function En(t,e){if(e>=Pt(t._capacity))return t._tail;if(e<1<<t._level+S){for(var r=t._root,n=t._level;r&&n>0;)r=r.array[e>>>n&A],n-=S;return r}}function it(t,e,r){e!==void 0&&(e|=0),r!==void 0&&(r|=0);var n=t.__ownerID||new Ae,i=t._origin,o=t._capacity,a=i+e,s=r===void 0?o:r<0?o+r:i+r;if(a===i&&s===o)return t;if(a>=s)return t.clear();for(var u=t._level,f=t._root,h=0;a+h<0;)f=new ot(f&&f.array.length?[void 0,f]:[],n),u+=S,h+=1<<u;h&&(a+=h,i+=h,s+=h,o+=h);for(var c=Pt(o),p=Pt(s);p>=1<<u+S;)f=new ot(f&&f.array.length?[f]:[],n),u+=S;var l=t._tail,_=p<c?En(t,s-1):p>c?new ot([],n):l;if(l&&p>c&&a<o&&l.array.length){f=wt(f,n);for(var d=f,N=u;N>S;N-=S){var G=c>>>N&A;d=d.array[G]=wt(d.array[G],n)}d.array[c>>>S&A]=l}if(s<o&&(_=_&&_.removeAfter(n,0,s)),a>=p)a-=p,s-=p,u=S,f=null,_=_&&_.removeBefore(n,0,a);else if(a>i||p<c){for(h=0;f;){var ht=a>>>u&A;if(ht!==p>>>u&A)break;ht&&(h+=(1<<u)*ht),u-=S,f=f.array[ht]}f&&a>i&&(f=f.removeBefore(n,u,a-h)),f&&p<c&&(f=f.removeAfter(n,u,p-h)),h&&(a-=h,s-=h)}return t.__ownerID?(t.size=s-a,t._origin=a,t._capacity=s,t._level=u,t._root=f,t._tail=_,t.__hash=void 0,t.__altered=!0,t):Kt(a,s,u,f,_)}function Pt(t){return t<x?0:t-1>>>S<<S}var nt=function(t){function e(r){return r==null?$t():Zr(r)?r:$t().withMutations(function(n){var i=F(r);P(i.size),i.forEach(function(o,a){return n.set(a,o)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("OrderedMap {","}")},e.prototype.get=function(n,i){var o=this._map.get(n);return o!==void 0?this._list.get(o)[1]:i},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):$t()},e.prototype.set=function(n,i){return Rr(this,n,i)},e.prototype.remove=function(n){return Rr(this,n,v)},e.prototype.__iterate=function(n,i){var o=this;return this._list.__iterate(function(a){return a&&n(a[1],a[0],o)},i)},e.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},e.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),o=this._list.__ensureOwner(n);return n?tr(i,o,n,this.__hash):this.size===0?$t():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=o,this)},e}(Z);nt.isOrderedMap=Zr;nt.prototype[zt]=!0;nt.prototype[Ft]=nt.prototype.remove;function tr(t,e,r,n){var i=Object.create(nt.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var Ir;function $t(){return Ir||(Ir=tr(Y(),re()))}function Rr(t,e,r){var n=t._map,i=t._list,o=n.get(e),a=o!==void 0,s,u;if(r===v){if(!a)return t;i.size>=x&&i.size>=n.size*2?(u=i.filter(function(f,h){return f!==void 0&&o!==h}),s=u.toKeyedSeq().map(function(f){return f[0]}).flip().toMap(),t.__ownerID&&(s.__ownerID=u.__ownerID=t.__ownerID)):(s=n.remove(e),u=o===i.size-1?i.pop():i.set(o,void 0))}else if(a){if(r===i.get(o)[1])return t;s=n,u=i.set(o,[e,r])}else s=n.set(e,i.size),u=i.set(i.size,[e,r]);return t.__ownerID?(t.size=s.size,t._map=s,t._list=u,t.__hash=void 0,t.__altered=!0,t):tr(s,u)}var On="@@__IMMUTABLE_STACK__@@";function Te(t){return Boolean(t&&t[On])}var er=function(t){function e(r){return r==null?Vt():Te(r)?r:Vt().pushAll(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("Stack [","]")},e.prototype.get=function(n,i){var o=this._head;for(n=at(this,n);o&&n--;)o=o.next;return o?o.value:i},e.prototype.peek=function(){return this._head&&this._head.value},e.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,o=this._head,a=arguments.length-1;a>=0;a--)o={value:n[a],next:o};return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):jt(i,o)},e.prototype.pushAll=function(n){if(n=t(n),n.size===0)return this;if(this.size===0&&Te(n))return n;P(n.size);var i=this.size,o=this._head;return n.__iterate(function(a){i++,o={value:a,next:o}},!0),this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):jt(i,o)},e.prototype.pop=function(){return this.slice(1)},e.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Vt()},e.prototype.slice=function(n,i){if(oe(n,i,this.size))return this;var o=Wt(n,this.size),a=ae(i,this.size);if(a!==this.size)return t.prototype.slice.call(this,n,i);for(var s=this.size-o,u=this._head;o--;)u=u.next;return this.__ownerID?(this.size=s,this._head=u,this.__hash=void 0,this.__altered=!0,this):jt(s,u)},e.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?jt(this.size,this._head,n,this.__hash):this.size===0?Vt():(this.__ownerID=n,this.__altered=!1,this)},e.prototype.__iterate=function(n,i){var o=this;if(i)return new pt(this.toArray()).__iterate(function(u,f){return n(u,f,o)},i);for(var a=0,s=this._head;s&&n(s.value,a++,this)!==!1;)s=s.next;return a},e.prototype.__iterator=function(n,i){if(i)return new pt(this.toArray()).__iterator(n,i);var o=0,a=this._head;return new y(function(){if(a){var s=a.value;return a=a.next,E(n,o++,s)}return D()})},e}(_t);er.isStack=Te;var k=er.prototype;k[On]=!0;k.shift=k.pop;k.unshift=k.push;k.unshiftAll=k.pushAll;k.withMutations=Ht;k.wasAltered=Ze;k.asImmutable=Xt;k["@@transducer/init"]=k.asMutable=Jt;k["@@transducer/step"]=function(t,e){return t.unshift(e)};k["@@transducer/result"]=function(t){return t.asImmutable()};function jt(t,e,r,n){var i=Object.create(k);return i.size=t,i._head=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var Tr;function Vt(){return Tr||(Tr=jt(0))}var bn="@@__IMMUTABLE_SET__@@";function rr(t){return Boolean(t&&t[bn])}function Mn(t){return rr(t)&&H(t)}function zn(t,e){if(t===e)return!0;if(!j(e)||t.size!==void 0&&e.size!==void 0&&t.size!==e.size||t.__hash!==void 0&&e.__hash!==void 0&&t.__hash!==e.__hash||O(t)!==O(e)||$(t)!==$(e)||H(t)!==H(e))return!1;if(t.size===0&&e.size===0)return!0;var r=!se(t);if(H(t)){var n=t.entries();return e.every(function(u,f){var h=n.next().value;return h&&R(h[1],u)&&(r||R(h[0],f))})&&n.next().done}var i=!1;if(t.size===void 0)if(e.size===void 0)typeof t.cacheResult=="function"&&t.cacheResult();else{i=!0;var o=t;t=e,e=o}var a=!0,s=e.__iterate(function(u,f){if(r?!t.has(u):i?!R(u,t.get(f,v)):!R(t.get(f,v),u))return a=!1,!1});return a&&t.size===s}function lt(t,e){var r=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(r),t}function ie(t){if(!t||typeof t!="object")return t;if(!j(t)){if(!st(t))return t;t=B(t)}if(O(t)){var e={};return t.__iterate(function(n,i){e[i]=ie(n)}),e}var r=[];return t.__iterate(function(n){r.push(ie(n))}),r}var pe=function(t){function e(r){return r==null?Dt():rr(r)&&!H(r)?r:Dt().withMutations(function(n){var i=t(r);P(i.size),i.forEach(function(o){return n.add(o)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(n){return this(F(n).keySeq())},e.intersect=function(n){return n=b(n).toArray(),n.length?T.intersect.apply(e(n.pop()),n):Dt()},e.union=function(n){return n=b(n).toArray(),n.length?T.union.apply(e(n.pop()),n):Dt()},e.prototype.toString=function(){return this.__toString("Set {","}")},e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return te(this,this._map.set(n,n))},e.prototype.remove=function(n){return te(this,this._map.remove(n))},e.prototype.clear=function(){return te(this,this._map.clear())},e.prototype.map=function(n,i){var o=this,a=!1,s=te(this,this._map.mapEntries(function(u){var f=u[1],h=n.call(i,f,f,o);return h!==f&&(a=!0),[h,h]},i));return a?s:this},e.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(o){return o.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(o){for(var a=0;a<n.length;a++)t(n[a]).forEach(function(s){return o.add(s)})})},e.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(a){return t(a)});var o=[];return this.forEach(function(a){n.every(function(s){return s.includes(a)})||o.push(a)}),this.withMutations(function(a){o.forEach(function(s){a.remove(s)})})},e.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(a){return t(a)});var o=[];return this.forEach(function(a){n.some(function(s){return s.includes(a)})&&o.push(a)}),this.withMutations(function(a){o.forEach(function(s){a.remove(s)})})},e.prototype.sort=function(n){return Ut(mt(this,n))},e.prototype.sortBy=function(n,i){return Ut(mt(this,i,n))},e.prototype.wasAltered=function(){return this._map.wasAltered()},e.prototype.__iterate=function(n,i){var o=this;return this._map.__iterate(function(a){return n(a,a,o)},i)},e.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},e.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},e}(bt);pe.isSet=rr;var T=pe.prototype;T[bn]=!0;T[Ft]=T.remove;T.merge=T.concat=T.union;T.withMutations=Ht;T.asImmutable=Xt;T["@@transducer/init"]=T.asMutable=Jt;T["@@transducer/step"]=function(t,e){return t.add(e)};T["@@transducer/result"]=function(t){return t.asImmutable()};T.__empty=Dt;T.__make=In;function te(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:e.size===0?t.__empty():t.__make(e)}function In(t,e){var r=Object.create(T);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}var qr;function Dt(){return qr||(qr=In(Y()))}var wi=function(t){function e(r,n,i){if(!(this instanceof e))return new e(r,n,i);if(Ke(i!==0,"Cannot step a Range by 0"),r=r||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<r&&(i=-i),this._start=r,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-r)/i-1)+1),this.size===0){if(we)return we;we=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},e.prototype.get=function(n,i){return this.has(n)?this._start+at(this,n)*this._step:i},e.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},e.prototype.slice=function(n,i){return oe(n,i,this.size)?this:(n=Wt(n,this.size),i=ae(i,this.size),i<=n?new e(0,0):new e(this.get(n,this._end),this.get(i,this._end),this._step))},e.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var o=i/this._step;if(o>=0&&o<this.size)return o}return-1},e.prototype.lastIndexOf=function(n){return this.indexOf(n)},e.prototype.__iterate=function(n,i){for(var o=this.size,a=this._step,s=i?this._start+(o-1)*a:this._start,u=0;u!==o&&n(s,i?o-++u:u++,this)!==!1;)s+=i?-a:a;return u},e.prototype.__iterator=function(n,i){var o=this.size,a=this._step,s=i?this._start+(o-1)*a:this._start,u=0;return new y(function(){if(u===o)return D();var f=s;return s+=i?-a:a,E(n,i?o-++u:u++,f)})},e.prototype.equals=function(n){return n instanceof e?this._start===n._start&&this._end===n._end&&this._step===n._step:zn(this,n)},e}(X),we;function Rn(t,e,r){for(var n=fn(e),i=0;i!==n.length;)if(t=hn(t,n[i++],v),t===v)return r;return t}function Tn(t,e){return Rn(this,t,e)}function Ei(t,e){return Rn(t,e,v)!==v}function Oi(t){return Ei(this,t)}function qn(){P(this.size);var t={};return this.__iterate(function(e,r){t[r]=e}),t}b.isIterable=j;b.isKeyed=O;b.isIndexed=$;b.isAssociative=se;b.isOrdered=H;b.Iterator=y;lt(b,{toArray:function(){P(this.size);var e=new Array(this.size||0),r=O(this),n=0;return this.__iterate(function(i,o){e[n++]=r?[o,i]:i}),e},toIndexedSeq:function(){return new Qr(this)},toJS:function(){return ie(this)},toKeyedSeq:function(){return new ce(this,!0)},toMap:function(){return Z(this.toKeyedSeq())},toObject:qn,toOrderedMap:function(){return nt(this.toKeyedSeq())},toOrderedSet:function(){return Ut(O(this)?this.valueSeq():this)},toSet:function(){return pe(O(this)?this.valueSeq():this)},toSetSeq:function(){return new Vr(this)},toSeq:function(){return $(this)?this.toIndexedSeq():O(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return er(O(this)?this.valueSeq():this)},toList:function(){return et(O(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,r){return this.size===0?e+r:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+r},concat:function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return m(this,Vn(this,e))},includes:function(e){return this.some(function(r){return R(r,e)})},entries:function(){return this.__iterator(U)},every:function(e,r){P(this.size);var n=!0;return this.__iterate(function(i,o,a){if(!e.call(r,i,o,a))return n=!1,!1}),n},filter:function(e,r){return m(this,nn(this,e,r,!0))},find:function(e,r,n){var i=this.findEntry(e,r);return i?i[1]:n},forEach:function(e,r){return P(this.size),this.__iterate(r?e.bind(r):e)},join:function(e){P(this.size),e=e!==void 0?""+e:",";var r="",n=!0;return this.__iterate(function(i){n?n=!1:r+=e,r+=i!=null?i.toString():""}),r},keys:function(){return this.__iterator(Yt)},map:function(e,r){return m(this,rn(this,e,r))},reduce:function(e,r,n){return Ar(this,e,r,n,arguments.length<2,!1)},reduceRight:function(e,r,n){return Ar(this,e,r,n,arguments.length<2,!0)},reverse:function(){return m(this,Ce(this,!0))},slice:function(e,r){return m(this,Be(this,e,r,!0))},some:function(e,r){return!this.every(ee(e),r)},sort:function(e){return m(this,mt(this,e))},values:function(){return this.__iterator(J)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(e,r){return yt(e?this.toSeq().filter(e,r):this)},countBy:function(e,r){return Zn(this,e,r)},equals:function(e){return zn(this,e)},entrySeq:function(){var e=this;if(e._cache)return new pt(e._cache);var r=e.toSeq().map(Mi).toIndexedSeq();return r.fromEntrySeq=function(){return e.toSeq()},r},filterNot:function(e,r){return this.filter(ee(e),r)},findEntry:function(e,r,n){var i=n;return this.__iterate(function(o,a,s){if(e.call(r,o,a,s))return i=[a,o],!1}),i},findKey:function(e,r){var n=this.findEntry(e,r);return n&&n[0]},findLast:function(e,r,n){return this.toKeyedSeq().reverse().find(e,r,n)},findLastEntry:function(e,r,n){return this.toKeyedSeq().reverse().findEntry(e,r,n)},findLastKey:function(e,r){return this.toKeyedSeq().reverse().findKey(e,r)},first:function(e){return this.find(Nr,null,e)},flatMap:function(e,r){return m(this,ti(this,e,r))},flatten:function(e){return m(this,an(this,e,!0))},fromEntrySeq:function(){return new tn(this)},get:function(e,r){return this.find(function(n,i){return R(i,e)},void 0,r)},getIn:Tn,groupBy:function(e,r){return Gn(this,e,r)},has:function(e){return this.get(e,v)!==v},hasIn:Oi,isSubset:function(e){return e=typeof e.includes=="function"?e:b(e),this.every(function(r){return e.includes(r)})},isSuperset:function(e){return e=typeof e.isSubset=="function"?e:b(e),e.isSubset(this)},keyOf:function(e){return this.findKey(function(r){return R(r,e)})},keySeq:function(){return this.toSeq().map(bi).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return Gt(this,e)},maxBy:function(e,r){return Gt(this,r,e)},min:function(e){return Gt(this,e?kr(e):$r)},minBy:function(e,r){return Gt(this,r?kr(r):$r,e)},rest:function(){return this.slice(1)},skip:function(e){return e===0?this:this.slice(Math.max(0,e))},skipLast:function(e){return e===0?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,r){return m(this,on(this,e,r,!0))},skipUntil:function(e,r){return this.skipWhile(ee(e),r)},sortBy:function(e,r){return m(this,mt(this,r,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,r){return m(this,Qn(this,e,r))},takeUntil:function(e,r){return this.takeWhile(ee(e),r)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=zi(this))}});var q=b.prototype;q[xr]=!0;q[ue]=q.values;q.toJSON=q.toArray;q.__toStringMapper=Ct;q.inspect=q.toSource=function(){return this.toString()};q.chain=q.flatMap;q.contains=q.includes;lt(F,{flip:function(){return m(this,en(this))},mapEntries:function(e,r){var n=this,i=0;return m(this,this.toSeq().map(function(o,a){return e.call(r,[a,o],i++,n)}).fromEntrySeq())},mapKeys:function(e,r){var n=this;return m(this,this.toSeq().flip().map(function(i,o){return e.call(r,i,o,n)}).flip())}});var Zt=F.prototype;Zt[Kr]=!0;Zt[ue]=q.entries;Zt.toJSON=qn;Zt.__toStringMapper=function(t,e){return Ct(e)+": "+Ct(t)};lt(_t,{toKeyedSeq:function(){return new ce(this,!1)},filter:function(e,r){return m(this,nn(this,e,r,!1))},findIndex:function(e,r){var n=this.findEntry(e,r);return n?n[0]:-1},indexOf:function(e){var r=this.keyOf(e);return r===void 0?-1:r},lastIndexOf:function(e){var r=this.lastKeyOf(e);return r===void 0?-1:r},reverse:function(){return m(this,Ce(this,!1))},slice:function(e,r){return m(this,Be(this,e,r,!1))},splice:function(e,r){var n=arguments.length;if(r=Math.max(r||0,0),n===0||n===2&&!r)return this;e=Wt(e,e<0?this.count():this.size);var i=this.slice(0,e);return m(this,n===1?i:i.concat(Q(arguments,2),this.slice(e+r)))},findLastIndex:function(e,r){var n=this.findLastEntry(e,r);return n?n[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return m(this,an(this,e,!1))},get:function(e,r){return e=at(this,e),e<0||this.size===1/0||this.size!==void 0&&e>this.size?r:this.find(function(n,i){return i===e},void 0,r)},has:function(e){return e=at(this,e),e>=0&&(this.size!==void 0?this.size===1/0||e<this.size:this.indexOf(e)!==-1)},interpose:function(e){return m(this,ei(this,e))},interleave:function(){var e=[this].concat(Q(arguments)),r=Qt(this.toSeq(),X.of,e),n=r.flatten(!0);return r.size&&(n.size=r.size*e.length),m(this,n)},keySeq:function(){return wi(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,r){return m(this,on(this,e,r,!1))},zip:function(){var e=[this].concat(Q(arguments));return m(this,Qt(this,Lr,e))},zipAll:function(){var e=[this].concat(Q(arguments));return m(this,Qt(this,Lr,e,!0))},zipWith:function(e){var r=Q(arguments);return r[0]=this,m(this,Qt(this,e,r))}});var qt=_t.prototype;qt[Pr]=!0;qt[zt]=!0;lt(bt,{get:function(e,r){return this.has(e)?e:r},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}});var Et=bt.prototype;Et.has=q.includes;Et.contains=Et.includes;Et.keys=Et.values;lt(ut,Zt);lt(X,qt);lt(Rt,Et);function Ar(t,e,r,n,i,o){return P(t.size),t.__iterate(function(a,s,u){i?(i=!1,r=a):r=e.call(n,r,a,s,u)},o),r}function bi(t,e){return e}function Mi(t,e){return[e,t]}function ee(t){return function(){return!t.apply(this,arguments)}}function kr(t){return function(){return-t.apply(this,arguments)}}function Lr(){return Q(arguments)}function $r(t,e){return t<e?1:t>e?-1:0}function zi(t){if(t.size===1/0)return 0;var e=H(t),r=O(t),n=e?1:0,i=t.__iterate(r?e?function(o,a){n=31*n+jr(C(o),C(a))|0}:function(o,a){n=n+jr(C(o),C(a))|0}:e?function(o){n=31*n+C(o)|0}:function(o){n=n+C(o)|0});return Ii(i,n)}function Ii(t,e){return e=Lt(e,3432918353),e=Lt(e<<15|e>>>-15,461845907),e=Lt(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=Lt(e^e>>>16,2246822507),e=Lt(e^e>>>13,3266489909),e=he(e^e>>>16),e}function jr(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}var Ut=function(t){function e(r){return r==null?qe():Mn(r)?r:qe().withMutations(function(n){var i=bt(r);P(i.size),i.forEach(function(o){return n.add(o)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(n){return this(F(n).keySeq())},e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},e}(pe);Ut.isOrderedSet=Mn;var dt=Ut.prototype;dt[zt]=!0;dt.zip=qt.zip;dt.zipWith=qt.zipWith;dt.zipAll=qt.zipAll;dt.__empty=qe;dt.__make=An;function An(t,e){var r=Object.create(dt);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}var Dr;function qe(){return Dr||(Dr=An($t()))}function Ri(t){if(Mt(t))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(V(t))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(t===null||typeof t!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var I=function(e,r){var n;Ri(e);var i=function(s){var u=this;if(s instanceof i)return s;if(!(this instanceof i))return new i(s);if(!n){n=!0;var f=Object.keys(e),h=o._indices={};o._name=r,o._keys=f,o._defaultValues=e;for(var c=0;c<f.length;c++){var p=f[c];h[p]=c,o[p]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+ir(this)+' with property "'+p+'" since that property name is part of the Record API.'):Ti(o,p)}}return this.__ownerID=void 0,this._values=et().withMutations(function(l){l.setSize(u._keys.length),F(s).forEach(function(_,d){l.set(u._indices[d],_===u._defaultValues[d]?void 0:_)})}),this},o=i.prototype=Object.create(g);return o.constructor=i,r&&(i.displayName=r),i};I.prototype.toString=function(){for(var e=ir(this)+" { ",r=this._keys,n,i=0,o=r.length;i!==o;i++)n=r[i],e+=(i?", ":"")+n+": "+Ct(this.get(n));return e+" }"};I.prototype.equals=function(e){return this===e||Mt(e)&&Ot(this).equals(Ot(e))};I.prototype.hashCode=function(){return Ot(this).hashCode()};I.prototype.has=function(e){return this._indices.hasOwnProperty(e)};I.prototype.get=function(e,r){if(!this.has(e))return r;var n=this._indices[e],i=this._values.get(n);return i===void 0?this._defaultValues[e]:i};I.prototype.set=function(e,r){if(this.has(e)){var n=this._values.set(this._indices[e],r===this._defaultValues[e]?void 0:r);if(n!==this._values&&!this.__ownerID)return nr(this,n)}return this};I.prototype.remove=function(e){return this.set(e)};I.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:nr(this,e)};I.prototype.wasAltered=function(){return this._values.wasAltered()};I.prototype.toSeq=function(){return Ot(this)};I.prototype.toJS=function(){return ie(this)};I.prototype.entries=function(){return this.__iterator(U)};I.prototype.__iterator=function(e,r){return Ot(this).__iterator(e,r)};I.prototype.__iterate=function(e,r){return Ot(this).__iterate(e,r)};I.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var r=this._values.__ensureOwner(e);return e?nr(this,r,e):(this.__ownerID=e,this._values=r,this)};I.isRecord=Mt;I.getDescriptiveName=ir;var g=I.prototype;g[Fr]=!0;g[Ft]=g.remove;g.deleteIn=g.removeIn=Ue;g.getIn=Tn;g.hasIn=q.hasIn;g.merge=_n;g.mergeWith=ln;g.mergeIn=Je;g.mergeDeep=vn;g.mergeDeepWith=yn;g.mergeDeepIn=Xe;g.setIn=Pe;g.update=Fe;g.updateIn=We;g.withMutations=Ht;g.asMutable=Jt;g.asImmutable=Xt;g[ue]=g.entries;g.toJSON=g.toObject=q.toObject;g.inspect=g.toSource=function(){return this.toString()};function nr(t,e,r){var n=Object.create(Object.getPrototypeOf(t));return n._values=e,n.__ownerID=r,n}function ir(t){return t.constructor.displayName||t.constructor.name||"Record"}function Ot(t){return je(t._keys.map(function(e){return[e,t.get(e)]}))}function Ti(t,e){try{Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(r){Ke(this.__ownerID,"Cannot set on an immutable record."),this.set(e,r)}})}catch{}}var qi=`${1e7}-${1e3}-${4e3}-${8e3}-${1e11}`,Ai=t=>(t^Math.random()*16>>t/4).toString(16);function _e(t){return t?Ai(Number(t)):qi.replace(/[018]/g,_e)}var le={};cr(le,{applyState:()=>At,isNew:()=>or});function At(t,e){return e===void 0||Object.keys(e).length==0?t:t.merge(Object.entries(e))}function or(t,e,r){return t.has(e)&&!R(t.get(e),r)}function Ln(t,e){let r=t;return r.key=e,r}var kn=Z({modalStack:et(),modalNodes:et(),closeCallbacks:Z()});function ar(t){var e;if(t>=0){let r=(e=this.modalStack.get(t))==null?void 0:e.key,n=this.closeCallbacks.get(r);n!==void 0&&n(),this.modalState=At(this.modalState,{modalStack:this.modalStack.delete(t),modalNodes:this.modalNodes.delete(t),closeCallbacks:this.closeCallbacks.delete(r)})}}function ki(t,e,r){let n=this.modalStack.findIndex(i=>i.key===t);n>=0&&(this.modalState=At(this.modalState,{modalStack:this.modalStack.set(n,Ln(e,t)),closeCallbacks:r!==void 0?this.closeCallbacks.set(t,r):this.closeCallbacks.delete(t)}))}var Li={host:void 0,set modalState(t){or(t,"modalStack",this.modalStack)&&this.host.offerState(Z({modalStack:t.get("modalStack")})),kn=t},get modalState(){return kn},get modalStack(){return this.modalState.get("modalStack")},get modalNodes(){return this.modalState.get("modalNodes")},get closeCallbacks(){return this.modalState.get("closeCallbacks")},attach(t){this.host===void 0?(this.host=t).addController(this):console.error("You attempted to attach a singleton controller to more than one host.")},hostConnected(){this.host.offerState(Z({modalStack:this.modalStack}))},hostUpdated(){this.modalState=At(this.modalState,{modalNodes:et(this.host.modalNodes)})},push(t,e){let r=_e();return this.modalState=At(this.modalState,{modalStack:this.modalStack.push(Ln(t,r)),closeCallbacks:e!==void 0?this.closeCallbacks.set(r,e):this.closeCallbacks}),{remove:()=>this.removeByKey(r),replace:(n,i)=>ki.call(this,r,n,i)}},pop(){ar.call(this,this.modalStack.size-1)},removeByNode(t){ar.call(this,this.modalNodes.indexOf(t))},removeByKey(t){ar.call(this,this.modalStack.findIndex(e=>e.key===t))},removeAll(){for(;this.modalStack.size>0;)this.pop()}},kt=Li;var ft=class extends $i{constructor(){super();this.modalStack=et();this.portalRef=xi();this.removeModal=r=>{r.stopImmediatePropagation(),r.preventDefault();let n=r.composedPath(),i=n.findIndex(o=>o===this.portalRef.value);if(i<1)console.warn("Could not locate modal portal at appropriate depth in the @removeModal event path");else{let o=n[i-1];kt.removeByNode(o)}};kt.attach(this)}get modalNodes(){var r;return(r=this.portalRef.value)==null?void 0:r.children}offerState(r){R(this.modalStack,r.get("modalStack"))||(this.modalStack=r.get("modalStack"),this.modalStack.size>0?document.querySelector("body").classList.add("modal-portal-active"):document.querySelector("body").classList.remove("modal-portal-active"))}connectedCallback(){super.connectedCallback(),this.addEventListener("removeModal",this.removeModal)}render(){var r;return $n`
      <div id="portal" ${Bi(this.portalRef)}>
        ${Ci((r=this.modalStack)==null?void 0:r.values(),n=>n.key,n=>$n`<div class="modal-node">${n}</div>`)}
      </div>
    `}};ft.styles=ji`
    #portal {
      isolation: isolate;
    }
  `,z([Ni()],ft.prototype,"modalStack",2),ft=z([Di("modal-portal")],ft);import{Directive as Ki,directive as Pi}from"lit/directive.js";var sr=class extends Ki{getTemplate(r){return r instanceof Function?r():r}render(r,n,i){r instanceof Function&&(r=r()),this.modalRegistry?r?this.modalRegistry.replace(this.getTemplate(n),i):(this.modalRegistry.remove(),this.modalRegistry=void 0):r&&(this.modalRegistry=kt.push(this.getTemplate(n),i))}},Ui=Pi(sr);var fr={};cr(fr,{ConfirmModal:()=>L,LitDialog:()=>W,WithLitDialog:()=>ve,state:()=>le});import{LitElement as Fi,html as Wi,css as Yi}from"lit";import{customElement as Hi,property as de}from"lit/decorators.js";import{ref as Ji,createRef as Xi}from"lit/directives/ref.js";import{classMap as Zi}from"lit/directives/class-map.js";var W=class extends Fi{constructor(){super(...arguments);this.dialogRef=Xi();this.label="";this.enableLightDismiss=!1;this.size="small";this.unsetStyles=!0}get dialog(){return this.dialogRef.value}get classes(){return{unset:this.unsetStyles}}close(){var r;(r=this.dialog)==null||r.close()}onDialogClose(){this.dispatchEvent(new Event("removeModal",{bubbles:!0,composed:!0}))}firstUpdated(){this.dialog.showModal(),this.dialog.addEventListener("close",()=>this.onDialogClose()),this.enableLightDismiss&&this.dialog.addEventListener("click",r=>this.onClick(r))}onClick(r){r.target===this.dialog&&this.close()}render(){return Wi`
      <dialog
        ${Ji(this.dialogRef)}
        class=${Zi(this.classes)}
        size=${this.size}
        aria-label="${this.label}"
        aria-modal="true"
      >
        <slot></slot>
      </dialog>
    `}};W.styles=Yi`
    dialog {
      display: flex;
      justify-content: center;
    }

    dialog.unset {
      border: unset;
      background: unset;
      max-width: unset;
      max-height: unset;
      height: unset;
      width: unset;
      margin: unset;
    }

    dialog::backdrop {
      background: var(--lit-dialog-backdrop-bg, hsl(0 0% 0% / 0.3));
    }

    dialog[size='small'] {
      align-items: center;
    }

    dialog[size='large'] {
      padding: 4rem;
    }
  `,z([de()],W.prototype,"label",2),z([de({type:Boolean,attribute:!1})],W.prototype,"enableLightDismiss",2),z([de()],W.prototype,"size",2),z([de({type:Boolean,attribute:!1})],W.prototype,"unsetStyles",2),W=z([Hi("lit-dialog")],W);import{LitElement as Qi,html as ur,css as Vi}from"lit";import{customElement as to,property as vt}from"lit/decorators.js";import{when as jn}from"lit/directives/when.js";import{ref as eo}from"lit/directives/ref.js";import{createRef as Gi}from"lit/directives/ref.js";var ve=t=>{class e extends t{constructor(){super(...arguments);this.litDialogRef=Gi()}closeDialog(){var i;(i=this.litDialogRef.value)==null||i.close()}}return e};var L=class extends ve(Qi){constructor(){super(...arguments);this.cancelLabel="Cancel";this.confirmLabel="Confirm";this.secondaryLabel="Alternative";this.closeOnConfirmation=!0;this.enableLightDismiss=!0}handleConfirm(){this.confirmCallback&&(this.confirmCallback(),this.closeOnConfirmation&&this.closeDialog())}handleSecondaryAction(){this.secondaryAction&&(this.secondaryAction(),this.closeDialog())}render(){return ur`
      <lit-dialog
        ${eo(this.litDialogRef)}
        label=${this.confirmLabel}
        .enableLightDismiss=${this.enableLightDismiss}
      >
        <div class="confirmation-dialog">
          <div>
            <slot>
              <p>
                This is the message that asks the user to confirm the action. This component also
                has properties for a secondary action.
              </p>
            </slot>
          </div>
          <div class="button-row">
            <button @click=${()=>this.closeDialog()} autofocus>${this.cancelLabel}</button>
            <span class="spacer"></span>
            ${jn(this.secondaryAction,()=>ur`
                  <button @click=${()=>this.handleSecondaryAction()}>
                    ${this.secondaryLabel}
                  </button>
                `)}
            ${jn(this.confirmCallback,()=>ur`<button @click=${()=>this.handleConfirm()}>${this.confirmLabel}</button>`)}
          </div>
        </div>
      </lit-dialog>
    `}};L.styles=[Vi`
      .confirmation-dialog {
        background: white;
        padding: 1rem;
        border-radius: 0.5rem;
        border: 2px solid black;
        max-width: 480px;
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .button-row {
        display: flex;
        gap: 1rem;
      }

      .spacer {
        flex-grow: 1;
      }
    `],z([vt({attribute:"cancel-label"})],L.prototype,"cancelLabel",2),z([vt({attribute:"confirm-label"})],L.prototype,"confirmLabel",2),z([vt({attribute:!1})],L.prototype,"confirmCallback",2),z([vt({attribute:"secondary-label"})],L.prototype,"secondaryLabel",2),z([vt({attribute:!1})],L.prototype,"secondaryAction",2),z([vt({type:Boolean,attribute:!1})],L.prototype,"closeOnConfirmation",2),z([vt({type:Boolean,attribute:!1})],L.prototype,"enableLightDismiss",2),L=z([to("confirm-modal")],L);export{ft as ModalPortal,sr as PortalDirective,fr as lib,kt as modalController,Ui as portal};
//# sourceMappingURL=build.min.js.map
